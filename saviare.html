<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IPO - Saviare LTDA</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    background: linear-gradient(135deg, #0f9b0f, #38ef7d);
    color: white;
  }
  header {
    text-align: center;
    padding: 60px 20px 20px;
    position: relative;
  }
  h1 {
    font-size: 2em;
    animation: fadeInTitle 2s ease-in-out forwards;
    opacity: 0;
  }
  @keyframes fadeInTitle {
    to { opacity: 1; }
  }
  .avion {
    width: 120px;
    position: absolute;
    top: 80px;
    left: -150px;
    animation: avionFly 4s ease-out forwards;
  }
  @keyframes avionFly {
    0% { transform: translateX(0) rotate(0deg); }
    100% { transform: translateX(250px) translateY(-20px) rotate(10deg); }
  }
  form {
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    max-width: 600px;
    margin: auto;
    border-radius: 12px;
    backdrop-filter: blur(8px);
  }
  input, select, textarea {
    width: 100%;
    padding: 10px;
    margin: 6px 0;
    border: none;
    border-radius: 6px;
    outline: none;
  }
  button {
    background: #2ecc71;
    border: none;
    padding: 12px;
    width: 100%;
    color: white;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover {
    background: #27ae60;
  }
  .terminos {
    font-size: 0.9em;
    margin-top: 10px;
    color: #e0e0e0;
    background: rgba(0,0,0,0.2);
    padding: 8px;
    border-radius: 6px;
  }
</style>
</head>
<body>

<header>
  <img src="Avion.png" alt="Avi√≥n" class="avion">
  <h1>üçÄ ¬°Bienvenido al sistema IPO de Saviare LTDA!</h1>
</header>

<form id="ipoForm">
  <label>Fecha del peligro:</label>
  <input type="date" name="fechaPeligro" required>

  <label>Lugar del peligro / fase de vuelo:</label>
  <input type="text" name="lugar" required>

  <label>Base:</label>
  <select name="base" required>
    <option value="Villavicencio">Villavicencio</option>
    <option value="Mit√∫">Mit√∫</option>
  </select>

  <label>Nombre:</label>
  <input type="text" name="nombre">

  <label>Cargo:</label>
  <input type="text" name="cargo">

  <label>Descripci√≥n del peligro / error humano:</label>
  <textarea name="descripcion" rows="4" required></textarea>

  <label>Subir archivos (opcional):</label>
  <input type="file" name="files" multiple>

  <div class="terminos">
    <input type="checkbox" name="terminos" value="S√≠" required>
    Acepto los t√©rminos y condiciones: SAVIARE LTDA, promueve e incentiva los Informes de Peligros...
  </div>

  <button type="submit">Enviar</button>
</form>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbw1tdbD8DWL2kSDwHm5uSqcuPLrAg_VOWx9_xaMXW41tgd5O3ELK6vLEi5Kw283g0i-/exec';

document.getElementById('ipoForm').addEventListener('submit', e => {
  e.preventDefault();
  const formData = new FormData(e.target);
  const filesData = [];

  for (let file of formData.getAll('files')) {
    if (file.name) {
      const reader = new FileReader();
      reader.onload = () => {
        filesData.push({
          name: file.name,
          mimeType: file.type,
          base64: reader.result.split(',')[1]
        });
        if (filesData.length === formData.getAll('files').length) sendData();
      };
      reader.readAsDataURL(file);
    }
  }

  if (formData.getAll('files').length === 0) sendData();

  function sendData() {
    fetch(scriptURL, {
      method: 'POST',
      body: JSON.stringify({
        fechaPeligro: formData.get('fechaPeligro'),
        lugar: formData.get('lugar'),
        base: formData.get('base'),
        nombre: formData.get('nombre'),
        cargo: formData.get('cargo'),
        descripcion: formData.get('descripcion'),
        terminos: formData.get('terminos'),
        files: filesData
      })
    })
    .then(res => res.text())
    .then(text => alert(text === 'OK' ? 'Enviado correctamente ‚úÖ' : 'Error: ' + text))
    .catch(err => alert('Error: ' + err));
  }
});
</script>

</body>
</html>
